{
    # Global options
    admin off
}

# This will automatically use the domain Railway assigns to your service.
:{$PORT} {
    # Handle API routes first
    @api_paths path_regexp ^/api(?:$|/.*$)
    handle @api_paths {
        reverse_proxy http://localhost:5000
    }

    # Handle all other routes
    handle {
        root * /app/dist/public
        try_files {path} /index.html
        file_server
        encode gzip zstd
    }
}